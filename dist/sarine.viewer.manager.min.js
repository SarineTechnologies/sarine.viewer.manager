(function(){var a;a=function(){function a(a){d=a.fromTag,h=a.toTag,f=a.stoneViews,g=a.template,i=[],this.bind=a.template?e:c}var b,c,d,e,f,g,h,i;return i=[],f=void 0,d=void 0,h=void 0,f=void 0,g=void 0,a.prototype.bind=Error,c=function(a){var c;return c=$.Deferred(),$(a).find(d).each(function(){return function(a,d){var e,f;return e=$("<"+h+">"),f=$(d).attr("viewer"),e.data("type",f),e.addClass("viewer "+f),e.attr("id","viewr_"+a),$(d).replaceWith(e),b(f,e),c.resolve()}}(this)),c},e=function(a){var b,d;return b=$.Deferred(),d=[],$("<div>").load(g,function(){return $(this).find("script").each(function(){return function(b,c){return c.src?(d.push($.Deferred()),$.ajax({url:c.src,dataType:"script",async:!1,success:function(){return d.pop().resolve()}})):$("<script type='text/javascript'></script>").text(c.innerText).appendTo(a),c.remove()}}(this)),$(a).prepend($(this).children()),$.when.apply($,d).done(function(){return c(a).then(b.resolve)})}),b.then(function(){return $(document).trigger("loadTemplate")})},b=function(a,b){switch(a){case"realview":i.push(new Viewer.Dynamic.Sprite({src:f[a],element:b,jsonFileName:"/Jsons/iview.json",firstImagePath:"/Images/Eyeview/img0.jpg",spritesPath:"/EyeViewSprites/sprite",oneSprite:!0,autoPlay:!0}));break;case"topinspection":i.push(new Viewer.Dynamic.Sprite({src:f[a],element:b,jsonFileName:"/Jsons/impression.json",firstImagePath:"/Images/Impression/img0.jpg",spritesPath:"/ImpressionSprites/sprite_",oneSprite:!1}));break;case"light":i.push(new Viewer.Dynamic.Light({src:f[a],element:b}));break;default:return console.error(a,"not define!"),!1}return!0},a.prototype.getViewers=function(){return i},a.prototype.first_init=function(){var a;return a=$.Deferred(),$.when.apply($,i.map(function(a){return a.first_init()})).done(a.resolve),a},a.prototype.full_init=function(){var a;return a=$.Deferred(),$.when.apply($,i.map(function(a){return a.full_init()})).done(a.resolve),a},a.prototype.stop=function(){return i.forEach(function(a){return a.stop()})},a.prototype.play=function(){return i.forEach(function(a){return a.play(!0)})},a}(),this.ViewerManger=a}).call(this);